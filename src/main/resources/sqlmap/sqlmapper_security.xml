<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dw.board.mapper.HomeMapper">
<!-- 유저 정보 조회 -->
<select id="findByUserId" resultType="UserVO">
SELECT
		u.password AS password,
		u.name AS name,
		r.role_name AS roleName
FROM 
		user AS u
		INNER JOIN user_role AS ur
		ON u.user_no = ur.user_no
		INNER JOIN role AS r 
		ON r.role_no = ur.role_no
WHERE
		u.id = #{id}
</select>

<!-- 유저 저장 -->
<insert id="userSave" parameterType="UserVO">
INSERT INTO user
        (
            id,
            password,
            name
        )
VALUES
        (
            #{id},
            #{password},
            #{name}
        )
</insert>


<!-- 유저 권한 저장 -->
<insert id="userRoleSave">
		INSERT INTO user_role
        (
            user_no,
            role_no
        )
        VALUES
        (
            #{userNo},
            #{roleNo}
        )
</insert>

<!-- 유저 FK번호 알아내기 -->
<select id="findUserNo" resultType="Integer">
		SELECT 
			user_no
		FROM user
		WHERE id = #{id}
</select>


<!-- 권한 FK번호 알아내기 -->
<select id="findRoleNo" resultType="Integer">
		SELECT 
			role_no
		FROM role
		WHERE role_name = #{roleName}
</select>

</mapper>